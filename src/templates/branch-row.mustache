{{! Template for a single branch row with pipeline status }}
{{! Used by: GET /api/branches/:projectPath/:branchName }}
<tr hx-get="/api/branches/{{projectPath}}/{{branchName}}?includeJobs={{includeJobs}}&contentOnly=true" 
    hx-trigger="every 5s"
    hx-target="this"
    hx-swap="innerHTML"
    hx-indicator="#spinner-{{safeId}}"
    data-branch-id="{{safeId}}"
    data-last-refresh="{{lastRefresh}}">
  <td><code>{{branchName}}</code></td>
  {{#pipeline}}
    <td>
      <a href="{{web_url}}" target="_blank">
        <mark data-status="{{status}}">{{statusText}}</mark>
      </a>
      {{#hasDuration}}
        <small class="duration-text"> ⏱️ {{durationText}}</small>
      {{/hasDuration}}
      <span id="spinner-{{safeId}}" class="htmx-indicator">⏳</span>
      {{#hasJobs}}
        <details class="jobs-details">
          <summary class="jobs-summary">Ver jobs ({{jobs.length}})</summary>
          {{#hasStages}}
            <div class="jobs-stages-inline">
              {{#stages}}
                <div class="stage-inline">
                  <div class="stage-header-inline">{{name}}</div>
                  <div class="stage-jobs-inline">
                    {{#jobs}}
                      <a href="{{web_url}}" 
                         target="_blank" 
                         class="job-item" 
                         data-status="{{status}}"
                         title="{{name}} - {{status}}">
                        {{name}}
                      </a>
                    {{/jobs}}
                  </div>
                </div>
              {{/stages}}
            </div>
          {{/hasStages}}
          {{^hasStages}}
            <div class="jobs-list-inline">
              {{#jobs}}
                <a href="{{web_url}}" 
                   target="_blank" 
                   class="job-item" 
                   data-status="{{status}}"
                   title="{{name}} - {{status}}">
                  {{name}}
                </a>
              {{/jobs}}
            </div>
          {{/hasStages}}
        </details>
      {{/hasJobs}}
    </td>
    <td>
      <small title="{{../commitTitle}}">{{../commitShortId}}</small>
      <small class="refresh-time" data-timestamp="{{lastRefresh}}"></small>
    </td>
  {{/pipeline}}
  {{^pipeline}}
    {{#error}}
      <td colspan="2">
        <em>{{.}}</em>
        <span id="spinner-{{safeId}}" class="htmx-indicator">⏳</span>
      </td>
    {{/error}}
    {{^error}}
      <td>
        <mark data-status="none">No Pipeline</mark>
        <span id="spinner-{{safeId}}" class="htmx-indicator">⏳</span>
      </td>
      <td></td>
    {{/error}}
  {{/pipeline}}
</tr>
